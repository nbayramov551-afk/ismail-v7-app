<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>OMEGA ULTRA V16 - BOSS EDITION</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --neon-green: #00ff41;
            --boss-dark: #050505;
            --panel-bg: rgba(20, 20, 20, 0.95);
            --wa-green: #25d366;
            --hdr-gold: #ffcc00;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--boss-dark); color: #fff; height: 100vh; overflow: hidden; position: fixed; width: 100%; }

        /* Sƒ∞BER ≈ûƒ∞FR∆èL∆èM∆è Gƒ∞Rƒ∞≈ûƒ∞ */
        #auth-gate { position: fixed; inset: 0; background: #000; z-index: 20000; display: flex; align-items: center; justify-content: center; flex-direction: column; }
        .cyber-box { border: 2px solid var(--neon-green); padding: 40px; border-radius: 5px; background: rgba(0,255,65,0.05); text-align: center; box-shadow: 0 0 30px var(--neon-green); }
        .boss-input { background: #000; border: 1px solid var(--neon-green); color: var(--neon-green); padding: 15px; width: 280px; margin: 20px 0; font-family: 'Orbitron'; font-size: 18px; outline: none; text-align: center; }

        /* ∆èSAS ƒ∞NTERFEYS (WHATSAPP STYLE) */
        .app-container { display: none; height: 100vh; flex-direction: column; }
        header { background: #111; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }
        .tabs { display: flex; background: #111; }
        .tab { flex: 1; padding: 15px; text-align: center; color: #888; font-weight: bold; cursor: pointer; text-transform: uppercase; font-size: 13px; }
        .tab.active { color: var(--wa-green); border-bottom: 3px solid var(--wa-green); }

        /* Sƒ∞YAHILAR */
        .scroll-list { flex: 1; overflow-y: auto; background: #000; }
        .user-row { display: flex; align-items: center; padding: 15px; border-bottom: 0.1px solid #222; cursor: pointer; transition: 0.2s; }
        .user-row:hover { background: #111; }
        .avatar { width: 55px; height: 55px; border-radius: 50%; background: linear-gradient(45deg, #222, #444); margin-right: 15px; display: flex; align-items: center; justify-content: center; font-size: 22px; font-weight: 900; border: 2px solid var(--wa-green); }

        /* ULTRA HDR CHAT */
        #chat-window { position: fixed; inset: 0; background: #080808; z-index: 5000; transform: translateY(100%); transition: 0.4s cubic-bezier(0.1, 0.7, 1, 0.1); display: flex; flex-direction: column; }
        #chat-window.active { transform: translateY(0); }
        .chat-header { background: #111; padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; }
        .msg-area { flex: 1; overflow-y: auto; padding: 20px; background: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); display: flex; flex-direction: column; gap: 10px; }
        
        .bubble { max-width: 75%; padding: 12px 16px; border-radius: 18px; font-size: 15px; position: relative; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .me { align-self: flex-end; background: #005c4b; border-bottom-right-radius: 2px; }
        .them { align-self: flex-start; background: #202c33; border-bottom-left-radius: 2px; }

        /* HDR Vƒ∞DEO CALL P∆èNC∆èR∆èSƒ∞ */
        #call-overlay { position: fixed; inset: 0; background: #000; z-index: 10000; display: none; flex-direction: column; }
        .v-full { width: 100%; height: 100%; object-fit: cover; filter: contrast(1.1) brightness(1.1); }
        .v-mini { position: absolute; top: 30px; right: 20px; width: 120px; height: 180px; border-radius: 15px; border: 2px solid var(--neon-green); box-shadow: 0 0 15px var(--neon-green); object-fit: cover; z-index: 10001; }
        
        .call-controls { position: absolute; bottom: 40px; width: 100%; display: flex; justify-content: center; gap: 25px; z-index: 10002; }
        .c-btn { width: 70px; height: 70px; border-radius: 50%; border: none; font-size: 24px; color: #fff; display: flex; align-items: center; justify-content: center; cursor: pointer; backdrop-filter: blur(10px); }
        .hangup { background: #ff3b30; }
        .accept { background: #4cd964; animation: pulse 1.5s infinite; }
        .mute-btn { background: rgba(255,255,255,0.2); }

        /* MESAJ SAH∆èSƒ∞ */
        .input-box { background: #111; padding: 10px 15px; display: flex; align-items: center; gap: 10px; }
        .input-main { flex: 1; background: #2a3942; border: none; padding: 12px 20px; border-radius: 30px; color: #fff; outline: none; font-size: 16px; }

        @keyframes pulse { 0% {box-shadow: 0 0 0 0 rgba(76,217,100,0.7);} 70% {box-shadow: 0 0 0 20px rgba(76,217,100,0);} 100% {box-shadow: 0 0 0 0 rgba(76,217,100,0);} }
    </style>
</head>
<body>

    <audio id="ringtone" src="https://assets.mixkit.co/active_storage/sfx/1359/1359-preview.mp3" loop></audio>

    <div id="auth-gate">
        <div class="cyber-box">
            <h1 style="font-family:'Orbitron'; color:var(--neon-green); letter-spacing:5px;">OMEGA V16</h1>
            <p style="font-size:12px; margin-top:10px; color:#888;">MILITARY GRADE ENCRYPTION ACTIVE</p>
            <input type="text" id="boss-alias" class="boss-input" placeholder="ACCESS NAME...">
            <button onclick="unlock()" style="background:var(--neon-green); color:#000; border:none; padding:15px 40px; font-weight:900; font-family:'Orbitron'; cursor:pointer; width:100%;">Gƒ∞Rƒ∞≈ûƒ∞ T∆èSDƒ∞QL∆è</button>
        </div>
    </div>

    <div class="app-container" id="app">
        <header>
            <h2 style="color:var(--wa-green); font-family:'Orbitron';">WhatsApp <span style="font-size:10px; color:var(--hdr-gold);">ULTRA HDR</span></h2>
            <div style="display:flex; gap:20px; font-size:20px; color:#888;">
                <i class="fas fa-search"></i>
                <i class="fas fa-user-plus" onclick="addContact()"></i>
                <i class="fas fa-ellipsis-v"></i>
            </div>
        </header>
        
        <div class="tabs">
            <div class="tab active" onclick="tab('chats')">√áatlar</div>
            <div class="tab" onclick="tab('status')">Status</div>
            <div class="tab" onclick="tab('calls')">Z…ôngl…ôr</div>
        </div>

        <div id="chats" class="scroll-list"></div>
    </div>

    <div id="chat-window">
        <div class="chat-header">
            <div style="display:flex; align-items:center; gap:12px;">
                <i class="fas fa-arrow-left" onclick="closeChat()"></i>
                <div class="avatar" style="width:40px; height:40px; font-size:14px;" id="c-av">?</div>
                <div>
                    <b id="c-name">Dost</b><br>
                    <small style="color:var(--wa-green);">HDR Line Active</small>
                </div>
            </div>
            <div style="display:flex; gap:22px; font-size:20px; color:var(--wa-green);">
                <i class="fas fa-video" onclick="initCall(true)"></i>
                <i class="fas fa-phone" onclick="initCall(false)"></i>
            </div>
        </div>
        <div class="msg-area" id="feed"></div>
        <div class="input-box">
            <i class="far fa-smile" style="font-size:24px; color:#888;"></i>
            <input type="text" id="m-in" class="input-main" placeholder="T…ôhl√ºk…ôsiz mesaj...">
            <i class="fas fa-microphone" id="mic" style="font-size:22px; color:#888;" onmousedown="startRec()" onmouseup="stopRec()"></i>
            <button onclick="sendMsg()" style="background:none; border:none; color:var(--wa-green); font-size:24px;"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <div id="call-overlay">
        <video id="remote-v" class="v-full" autoplay playsinline></video>
        <video id="local-v" class="v-mini" autoplay muted playsinline></video>
        <div style="position:absolute; top:100px; width:100%; text-align:center;">
            <h2 id="call-user">X∆èTTD∆è...</h2>
            <div id="hdr-tag" style="display:inline-block; background:var(--hdr-gold); color:#000; padding:2px 8px; border-radius:4px; font-size:10px; font-weight:900; margin-top:10px;">ULTRA HDR 4K</div>
        </div>
        <div class="call-controls">
            <button class="c-btn mute-btn" id="toggle-mic" onclick="toggleAudio()"><i class="fas fa-microphone"></i></button>
            <button class="c-btn mute-btn" id="toggle-vid" onclick="toggleVideo()"><i class="fas fa-video"></i></button>
            <button id="ans-btn" class="c-btn accept" style="display:none;" onclick="answerCall()"><i class="fas fa-phone"></i></button>
            <button class="c-btn hangup" onclick="location.reload()"><i class="fas fa-phone-slash"></i></button>
        </div>
    </div>

    <script>
        let me, peer, activeChat, localStream, currentCall, recorder, chunks = [];
        const MASTER_SHIFRE = "ULTRA_MOSCOW_BOSS_256_BIT_AES_KEY_!!!";

        // Gƒ∞Rƒ∞≈û V∆è Sƒ∞STEMƒ∞N BA≈ûLATILMASI
        function unlock() {
            const n = document.getElementById('boss-alias').value;
            if(!n) return;
            me = { id: "BOSS-" + Math.floor(1000 + Math.random() * 9000), name: n };
            localStorage.setItem('omega_boss', JSON.stringify(me));
            document.getElementById('auth-gate').style.display = 'none';
            document.getElementById('app').style.display = 'flex';
            initPeer();
        }

        function initPeer() {
            peer = new Peer(me.id, {
                config: {'iceServers': [
                    { urls: 'stun:stun.l.google.com:19302' },
                    { urls: 'stun:stun1.l.google.com:19302' },
                    { urls: 'stun:stun.services.mozilla.com' }
                ]}
            });

            peer.on('connection', c => c.on('data', d => processData(d)));
            peer.on('call', c => {
                currentCall = c;
                document.getElementById('call-overlay').style.display = 'flex';
                document.getElementById('ans-btn').style.display = 'flex';
                document.getElementById('ringtone').play();
            });
            renderList();
        }

        // KONTAKTLAR
        function addContact() {
            const id = prompt("Dostun OMEGA ID-sini yaz (M…ôs…ôl…ôn: BOSS-1234):");
            if(!id) return;
            let db = JSON.parse(localStorage.getItem('omega_db') || "[]");
            if(!db.find(x => x.id === id)) db.push({id, msgs: []});
            localStorage.setItem('omega_db', JSON.stringify(db));
            renderList();
        }

        function renderList() {
            const l = document.getElementById('chats'); l.innerHTML = "";
            const db = JSON.parse(localStorage.getItem('omega_db') || "[]");
            db.forEach(u => {
                l.innerHTML += `
                    <div class="user-row" onclick="openChat('${u.id}')">
                        <div class="avatar">${u.id[5]}</div>
                        <div style="flex:1">
                            <b style="font-size:17px;">${u.id}</b><br>
                            <small style="color:#888;">üîí AES-256 ≈ûifr…ôl…ônmi≈ü Tunel</small>
                        </div>
                    </div>`;
            });
        }

        // MESAJLA≈ûMA (SUPER ENCRYPTION)
        function openChat(id) {
            activeChat = id; document.getElementById('c-name').innerText = id;
            document.getElementById('c-av').innerText = id[5];
            document.getElementById('chat-window').classList.add('active');
            renderMsgs();
        }

        function sendMsg() {
            const txt = document.getElementById('m-in').value; if(!txt) return;
            const msgObj = { f: me.id, type: 'text', body: txt, ts: Date.now() };
            encryptAndTransmit(msgObj);
            document.getElementById('m-in').value = "";
        }

        function encryptAndTransmit(obj) {
            let db = JSON.parse(localStorage.getItem('omega_db'));
            db.find(x => x.id === activeChat).msgs.push(obj);
            localStorage.setItem('omega_db', JSON.stringify(db));
            
            const conn = peer.connect(activeChat);
            conn.on('open', () => {
                const cipher = CryptoJS.AES.encrypt(JSON.stringify(obj), MASTER_SHIFRE).toString();
                conn.send(cipher);
                renderMsgs();
            });
        }

        function processData(cipher) {
            const dec = CryptoJS.AES.decrypt(cipher, MASTER_SHIFRE).toString(CryptoJS.enc.Utf8);
            const data = JSON.parse(dec);
            let db = JSON.parse(localStorage.getItem('omega_db') || "[]");
            let user = db.find(x => x.id === data.f);
            if(user) {
                user.msgs.push(data);
                localStorage.setItem('omega_db', JSON.stringify(db));
                if(activeChat === data.f) renderMsgs();
            }
        }

        function renderMsgs() {
            const feed = document.getElementById('feed'); feed.innerHTML = "";
            const db = JSON.parse(localStorage.getItem('omega_db'));
            const chat = db.find(x => x.id === activeChat);
            chat.msgs.forEach(m => {
                const side = m.f === me.id ? 'me' : 'them';
                if(m.type === 'text') feed.innerHTML += `<div class="bubble ${side}">${m.body}</div>`;
                else feed.innerHTML += `<div class="bubble ${side}" onclick="new Audio('${m.body}').play()"><i class="fas fa-play"></i> S∆èSLƒ∞ MESAJ</div>`;
            });
            feed.scrollTop = feed.scrollHeight;
        }

        // ULTRA HDR Vƒ∞DEO CALL ENGINE (Yandex Optimized)
        async function initCall(video) {
            document.getElementById('call-overlay').style.display = 'flex';
            // Yandex brauzer √º√ß√ºn HDR s…ôs v…ô g√∂r√ºnt√º parametrl…ôri
            localStream = await navigator.mediaDevices.getUserMedia({
                video: video ? { width: 1280, height: 720, frameRate: 30 } : false,
                audio: { echoCancellation: true, noiseSuppression: true, autoGainControl: true }
            });
            document.getElementById('local-v').srcObject = localStream;
            currentCall = peer.call(activeChat, localStream);
            handleCallStream();
        }

        async function answerCall() {
            document.getElementById('ringtone').pause();
            document.getElementById('ans-btn').style.display = 'none';
            localStream = await navigator.mediaDevices.getUserMedia({video: true, audio: true});
            document.getElementById('local-v').srcObject = localStream;
            currentCall.answer(localStream);
            handleCallStream();
        }

        function handleCallStream() {
            currentCall.on('stream', st => {
                document.getElementById('remote-v').srcObject = st;
                document.getElementById('call-user').innerText = "BAƒûLANTI T∆èHL√úK∆èSƒ∞Z";
            });
        }

        // ∆èYL∆èNC∆èLƒ∞ FUNKSƒ∞YALAR (S∆èS/G√ñR√úNT√ú ƒ∞DAR∆èSƒ∞)
        function toggleAudio() {
            const audioTrack = localStream.getAudioTracks()[0];
            audioTrack.enabled = !audioTrack.enabled;
            document.getElementById('toggle-mic').style.background = audioTrack.enabled ? "" : "red";
        }

        function toggleVideo() {
            const videoTrack = localStream.getVideoTracks()[0];
            videoTrack.enabled = !videoTrack.enabled;
            document.getElementById('toggle-vid').style.background = videoTrack.enabled ? "" : "red";
        }

        // SUPER S∆èSLƒ∞ MESAJ
        function startRec() {
            navigator.mediaDevices.getUserMedia({audio:true}).then(s => {
                recorder = new MediaRecorder(s);
                recorder.ondataavailable = e => chunks.push(e.data);
                recorder.onstop = () => {
                    const reader = new FileReader();
                    reader.onload = () => encryptAndTransmit({f: me.id, type:'audio', body: reader.result});
                    reader.readAsDataURL(new Blob(chunks)); chunks = [];
                };
                recorder.start();
                document.getElementById('mic').style.color = 'red';
            });
        }
        function stopRec() { if(recorder) { recorder.stop(); document.getElementById('mic').style.color = '#888'; } }

        function closeChat() { document.getElementById('chat-window').classList.remove('active'); }
        function tab(t) { console.log(t + " moduna ke√ßid"); }

        // AVTO-Gƒ∞Rƒ∞≈û
        window.onload = () => {
            const saved = localStorage.getItem('omega_boss');
            if(saved) {
                me = JSON.parse(saved);
                document.getElementById('auth-gate').style.display = 'none';
                document.getElementById('app').style.display = 'flex';
                initPeer();
            }
        };
    </script>
</body>
</html>
